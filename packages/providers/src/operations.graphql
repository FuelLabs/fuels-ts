# Fragments
fragment transactionFragment on Transaction {
  id
  rawPayload
  status {
    type: __typename
    ... on SubmittedStatus {
      time
    }
    ... on SuccessStatus {
      blockId
      time
      programState {
        returnType
        data
      }
    }
    ... on FailureStatus {
      blockId
      time
      reason
    }
  }
}

fragment receiptFragment on Receipt {
  id
  data
  rawPayload
}

fragment blockFragment on Block {
  id
  height
  producer
  transactions {
    id
  }
  time
}

fragment coinFragment on Coin {
  utxoId
  owner
  amount
  color
  maturity
  status
  blockCreated
}

# Queries and Mutations
query getVersion {
  version
}

query getChain {
  chain {
    name
    latestBlock {
      ...blockFragment
    }
    baseChainHeight
    peerCount
  }
}

query getTransaction($transactionId: HexString256!) {
  transaction(id: $transactionId) {
    ...transactionFragment
  }
}

query getTransactionWithReceipts($transactionId: HexString256!) {
  transaction(id: $transactionId) {
    ...transactionFragment
    receipts {
      ...receiptFragment
    }
  }
}

query getTransactions(
  $after: String
  $before: String
  $first: Int
  $last: Int
) {
  transactions(after: $after, before: $before, first: $first, last: $last) {
    edges {
      node {
        ...transactionFragment
      }
    }
  }
}

query getTransactionsByOwner(
  $owner: HexString256!
  $after: String
  $before: String
  $first: Int
  $last: Int
) {
  transactionsByOwner(
    owner: $owner
    after: $after
    before: $before
    first: $first
    last: $last
  ) {
    edges {
      node {
        ...transactionFragment
      }
    }
  }
}

query getBlock($blockId: HexString256, $blockHeight: Int) {
  block(id: $blockId, height: $blockHeight) {
    ...blockFragment
  }
}

query getBlockWithTransactions($blockId: HexString256, $blockHeight: Int) {
  block(id: $blockId, height: $blockHeight) {
    ...blockFragment
    transactions {
      ...transactionFragment
    }
  }
}

query getBlocks($after: String, $before: String, $first: Int, $last: Int) {
  blocks(after: $after, before: $before, first: $first, last: $last) {
    edges {
      node {
        ...blockFragment
      }
    }
  }
}

query getCoin($coinId: HexStringUtxoId!) {
  coin(utxoId: $coinId) {
    ...coinFragment
  }
}

query getCoins(
  $filter: CoinFilterInput!
  $after: String
  $before: String
  $first: Int
  $last: Int
) {
  coins(
    filter: $filter
    after: $after
    before: $before
    first: $first
    last: $last
  ) {
    edges {
      node {
        ...coinFragment
      }
    }
  }
}

mutation dryRun($encodedTransaction: HexString!) {
  dryRun(tx: $encodedTransaction) {
    ...receiptFragment
  }
}

mutation submit($encodedTransaction: HexString!) {
  submit(tx: $encodedTransaction)
}

mutation startSession {
  startSession
}

mutation endSession($sessionId: ID!) {
  endSession(id: $sessionId)
}

mutation execute($sessionId: ID!, $op: String!) {
  execute(id: $sessionId, op: $op)
}

mutation reset($sessionId: ID!) {
  reset(id: $sessionId)
}
